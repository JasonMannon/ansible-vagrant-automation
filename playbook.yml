---
- hosts: 127.0.0.1
  vars:
    http_port: 4568
    max_clients: 80
    createuser: 'ansibleremote'
    createpassword: 'myamazingpassword'
  remote_user: root
  tasks: 
    - name: Create uwsgi directory in log
      file: path=/var/log/uwsgi state=directory

    - name: Create uwsgi directory in etc
      file: path=/etc/uwsgi state=directory

    - name: Create vassals directory in uwsgi
      file: path=/etc/uwsgi/vassals state=directory

    - name: make link between files create symoblic link for uwsgi.ini
      file: src=/var/sites/stenosaurus/config/uwsgi.ini dest=/etc/uwsgi/vassals/stenosaurus.ini state=link

    - name: make link between files and create symbolic link for nginx.config
    - file: src=/var/sites/stenosaurus/config/nginx.conf dest=/etc/nginx/sites-enabled/stenosaurus state=link

    - name: Create emporor.ini file 
    - template: dest=/etc/uwsgi/emperor.ini src=/vagrant/templates/emperor.ini.j2

    - name: Create uwsgi.conf file 
    - template: dest=/etc/init/uwsgi.conf src=/vagrant/templates/uwsgi.ini.j2